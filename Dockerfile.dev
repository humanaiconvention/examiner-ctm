# Dev-mode container for Vite + React with HMR
FROM node:20-alpine

WORKDIR /workspace

# Install dependencies first (cache layer)
COPY web/package.json web/package-lock.json* ./web/
RUN cd web && npm ci

# Copy source (mounted volume can override in docker-compose)
COPY web ./web

WORKDIR /workspace/web

# Expose Vite default port
EXPOSE 5173

# Use CHOKIDAR polling inside container for reliable FS events (optional)
ENV CHOKIDAR_USEPOLLING=true
ENV HOST=0.0.0.0

# Start dev server
CMD ["npm","run","dev","--","--host","0.0.0.0"]
