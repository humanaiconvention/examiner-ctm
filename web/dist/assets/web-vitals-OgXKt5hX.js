let E=-1;const I=t=>{addEventListener("pageshow",(e=>{e.persisted&&(E=e.timeStamp,t(e))}),!0)},f=(t,e,i,n)=>{let r,o;return d=>{e.value>=0&&(d||n)&&(o=e.value-(r??0),(o||r===void 0)&&(r=e.value,e.delta=o,e.rating=((s,c)=>s>c[1]?"poor":s>c[0]?"needs-improvement":"good")(e.value,i),t(e)))}},w=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},S=()=>w()?.activationStart??0,g=(t,e=-1)=>{const i=w();let n="navigate";return E>=0?n="back-forward-cache":i&&(document.prerendering||S()>0?n="prerender":document.wasDiscarded?n="restore":i.type&&(n=i.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},h=new WeakMap;function N(t,e){return h.get(t)||h.set(t,new e),h.get(t)}const L=(t,e,i={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const n=new PerformanceObserver((r=>{Promise.resolve().then((()=>{e(r.getEntries())}))}));return n.observe({type:t,buffered:!0,...i}),n}}catch{}},A=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let a=-1;const M=new Set,y=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,v=t=>{if(document.visibilityState==="hidden"){if(t.type==="visibilitychange")for(const e of M)e();isFinite(a)||(a=t.type==="visibilitychange"?t.timeStamp:0,removeEventListener("prerenderingchange",v,!0))}},B=()=>{if(a<0){const t=S();a=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter((i=>i.name==="hidden"&&i.startTime>t))[0]?.startTime)??y(),addEventListener("visibilitychange",v,!0),addEventListener("prerenderingchange",v,!0),I((()=>{setTimeout((()=>{a=y()}))}))}return{get firstHiddenTime(){return a},onHidden(t){M.add(t)}}},H=t=>{document.prerendering?addEventListener("prerenderingchange",(()=>t()),!0):t()};let C=0,p=1/0,l=0;const x=t=>{for(const e of t)e.interactionId&&(p=Math.min(p,e.interactionId),l=Math.max(l,e.interactionId),C=l?(l-p)/7+1:0)};let m;const T=()=>m?C:performance.interactionCount??0,D=()=>{"interactionCount"in performance||m||(m=L("event",x,{type:"event",buffered:!0,durationThreshold:0}))};let b=0;class F{u=[];l=new Map;m;p;v(){b=T(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((T()-b)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!=="first-input")return;const i=this.u.at(-1);let n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>i.P){if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort(((r,o)=>o.P-r.P)),this.u.length>10){const r=this.u.splice(10);for(const o of r)this.l.delete(o.id)}this.p?.(n)}}}const O=t=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(t=A(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e((()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})})))},P=[200,500],_=(t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const i=B();H((()=>{D();let n,r=g("INP");const o=N(e,F),d=c=>{O((()=>{for(const k of c)o.h(k);const u=o.L();u&&u.P!==r.value&&(r.value=u.P,r.entries=u.entries,n())}))},s=L("event",d,{durationThreshold:e.durationThreshold??40});n=f(t,r,P,e.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),i.onHidden((()=>{d(s.takeRecords()),n(!0)})),I((()=>{o.v(),r=g("INP"),n=f(t,r,P,e.reportAllChanges)})))}))};export{P as INPThresholds,_ as onINP};
