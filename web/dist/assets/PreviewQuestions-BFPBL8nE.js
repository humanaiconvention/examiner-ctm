import{r as a,j as e}from"./index-BIvSWsE-.js";import{f as P}from"./analytics-core-Bh-KxoFz.js";import"./analytics-errors-CMEIYE25.js";const f=[{q:"How will humans and AI collaborate here?",a:"Through transparent tools, open metrics, and community-shaped guidelines."},{q:"What happens next after the preview?",a:"We iterate on visual language and release a participation SDK stub."}],D=6500,J=5,x="preview:question:draft:v1",S="preview:question:history:v1";function C(){try{const n=localStorage.getItem(S);if(!n)return[];const l=JSON.parse(n);return Array.isArray(l)?l:[]}catch{return[]}}const O=()=>!!(typeof window<"u"&&window.__PREVIEW_QUESTIONS_STATIC__),Y=()=>{const[n,l]=a.useState(0),[N,g]=a.useState(!1),[j,b]=a.useState(!1),o=a.useRef(null),[u,p]=a.useState(""),[c,m]=a.useState(""),[d,h]=a.useState(""),[y,v]=a.useState(null),[E,T]=a.useState(null),[I,w]=a.useState(null),[_,A]=a.useState([]),q=a.useCallback(()=>{l(s=>(s+1)%f.length)},[]);a.useEffect(()=>{try{const s=localStorage.getItem(x);if(s){const t=JSON.parse(s);t.name&&p(t.name),t.email&&m(t.email),t.question&&h(t.question)}}catch{}try{const s=localStorage.getItem(S);if(s){const t=JSON.parse(s);if(Array.isArray(t)){A(t);const i=[...t].reverse().find(r=>r.q||r.h);i?.q?w(i.q):i?.h&&w(`(previous submission hash ${i.h})`)}}}catch{}},[]),a.useEffect(()=>{if(!N)return o.current=window.setTimeout(q,D),()=>{o.current&&window.clearTimeout(o.current)}},[n,N,q]),a.useEffect(()=>{const s=window.setTimeout(()=>{try{localStorage.setItem(x,JSON.stringify({name:u,email:c,question:d}))}catch{}},120);return()=>window.clearTimeout(s)},[u,c,d]);const k=s=>{A(s);try{localStorage.setItem(S,JSON.stringify(s))}catch{}},R=()=>{p(""),m(""),h("");try{localStorage.removeItem(x)}catch{}},H=()=>{o.current&&window.clearTimeout(o.current),q()},Q=s=>{s.preventDefault(),v(null),T(null);const t=d.trim();if(!t){v("Please enter a question before submitting.");return}if((C().length||_.length)>=J){v("Rate limit reached. Please try again later.");return}const r=C();!r.length&&_.length&&r.push(..._);const M=[...r,{t:new Date().toISOString(),q:t,h:String(t.length)}];k(M),w(t),P({category:"interaction",action:"question_submit",metadata:{hasName:!!u.trim(),hasEmail:!!c.trim(),length:t.length}}),R(),T("Thanks for your question!")};return e.jsxs("div",{className:"preview-questions","data-preview-page-version":"carousel-1",children:[e.jsxs("header",{className:"preview-questions__header",children:[e.jsx("h1",{className:"preview-questions__title",children:"Preview Questions"}),e.jsx("p",{className:"preview-questions__lede",children:"Early visual + motion exploration. Two seed questions we posed internally:"})]}),e.jsxs("main",{className:"preview-questions__main","aria-live":"polite",children:[e.jsx("div",{className:"preview-questions__carousel",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:O()?f.map(s=>e.jsxs("div",{className:"preview-questions__slide is-active","aria-hidden":"false",children:[e.jsx("h2",{className:"preview-questions__q",children:s.q}),s.a&&e.jsx("p",{className:"preview-questions__a",children:s.a})]},s.q)):f.map((s,t)=>{const i=t===n;return e.jsxs("div",{className:`preview-questions__slide${i?" is-active":""}`,"aria-hidden":i?"false":"true",children:[e.jsx("h2",{className:"preview-questions__q",children:s.q}),s.a&&e.jsx("p",{className:"preview-questions__a",children:s.a})]},s.q)})}),e.jsx("div",{className:"preview-questions__controls",children:e.jsx("button",{type:"button",onClick:H,className:"preview-questions__skip","aria-label":"Skip to next question",children:"Skip ↺"})}),!O()&&e.jsxs("section",{className:"preview-questions__form-section","aria-live":"polite",children:[e.jsx("h2",{className:"preview-questions__form-heading",children:"Share your question"}),e.jsxs("form",{className:"preview-questions__form",onSubmit:Q,noValidate:!0,children:[e.jsxs("div",{className:"preview-field-group",children:[e.jsx("label",{htmlFor:"preview-name",children:"Name"}),e.jsx("input",{id:"preview-name",name:"name",type:"text",value:u,onChange:s=>p(s.target.value),autoComplete:"name",className:"preview-input"})]}),e.jsxs("div",{className:"preview-field-group",children:[e.jsx("label",{htmlFor:"preview-email",children:"Email"}),e.jsx("input",{id:"preview-email",name:"email",type:"email",value:c,onChange:s=>m(s.target.value),autoComplete:"email",className:"preview-input"})]}),e.jsxs("div",{className:"preview-field-group",children:[e.jsx("label",{htmlFor:"preview-question",children:"Your question"}),e.jsx("textarea",{id:"preview-question",name:"question",value:d,onChange:s=>h(s.target.value),rows:4,required:!0,className:"preview-textarea"})]}),e.jsx("div",{className:"preview-actions",children:e.jsx("button",{type:"submit",className:"btn-primary preview-questions__submit",children:"Submit question"})})]}),y&&e.jsx("div",{role:"alert",className:"preview-questions__error",children:y}),E&&e.jsx("div",{role:"status",className:"preview-questions__success preview-questions__success--active",children:E}),I&&e.jsxs("div",{className:"preview-questions__last","data-testid":"last-submission",children:[e.jsx("strong",{children:"Last question:"})," ",I]})]}),e.jsx("button",{type:"button",className:"preview-questions__answer-bubble","aria-haspopup":"dialog","aria-expanded":j?"true":"false",onClick:()=>b(s=>!s),children:"Answer here"}),j&&e.jsxs("div",{role:"dialog","aria-label":"Answer placeholder",className:"preview-questions__panel",children:[e.jsx("p",{className:"preview-questions__panel-text",children:"Interactive Q&A returns later. This bubble demonstrates the placement we explored earlier."}),e.jsx("button",{type:"button",className:"preview-questions__panel-close",onClick:()=>b(!1),children:"Close"})]}),e.jsx("div",{className:"preview-questions__note",children:"Motion prototype — submissions stored locally only."})]})]})};export{Y as default};
